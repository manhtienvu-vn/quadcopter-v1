/*
 * GAMEPAD.c
 *
 *  Created on: Jan 28, 2026
 *      Author: ADMIN
 */

#include "main.h"
#include "GAMEPAD.h"

typedef struct {
	uint8_t UP;
	uint8_t DOWN;
	uint8_t LEFT;
	uint8_t RIGHT;
	uint8_t TRIANGLE;
	uint8_t CIRCLE;
	uint8_t CROSS;
	uint8_t SQUARE;
	uint8_t L1;
	uint8_t L2;
	uint8_t R1;
	uint8_t R2;
	uint8_t LX;
	uint8_t LY;
	uint8_t RX;
	uint8_t RY;
	uint8_t buffer[4];
} GAMEPAD;

GAMEPAD gamepad;

void GAMEPAD_Init(UART_HandleTypeDef *huart){
	HAL_UART_Receive_DMA(huart, gamepad.buffer, 4);
}

void GAMEPAD_ParseData(){
	gamepad.UP = gamepad.buffer[0] & (1 << 7);
	gamepad.DOWN = gamepad.buffer[0] & (1 << 6);
	gamepad.LEFT = gamepad.buffer[0] & (1 << 5);
	gamepad.RIGHT = gamepad.buffer[0] & (1 << 4);
	gamepad.TRIANGLE = gamepad.buffer[0] & (1 << 3);
	gamepad.CROSS = gamepad.buffer[0] & (1 << 2);
	gamepad.CIRCLE = gamepad.buffer[0] & (1 << 1);
	gamepad.SQUARE = gamepad.buffer[0] & (1 << 0);
}

void GAMEPAD_Update();



